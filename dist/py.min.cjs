"use strict";var P=Object.create;var a=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var g=(t,i)=>{for(var n in i)a(t,n,{get:i[n],enumerable:!0})},l=(t,i,n,c)=>{if(i&&typeof i=="object"||typeof i=="function")for(let r of x(i))!w.call(t,r)&&r!==n&&a(t,r,{get:()=>i[r],enumerable:!(c=I(i,r))||c.enumerable});return t};var y=(t,i,n)=>(n=t!=null?P(S(t)):{},l(i||!t||!t.__esModule?a(n,"default",{value:t,enumerable:!0}):n,t)),z=t=>l(a({},"__esModule",{value:!0}),t);var j={};g(j,{Py:()=>e});module.exports=z(j);var _=y(require("node:path"),1),s=y(require("node:fs"),1),v=require("node:child_process"),[M,u,C,k]=function(){return E()?["python.exe","python","pip.exe","pip"]:N()?["python","python","pip","pip"]:O()?["python","python","pip","pip"]:[null,null,null,null]}();function E(){return process.platform==="win32"}function N(){return process.platform==="darwin"}function O(){return process.platform==="linux"}function h(t,i){return new Promise(function(n,c){let r="",f="",p=(0,v.spawn)(t,i);p.stdout.on("data",function(o){r+=o.toString()}),p.stderr.on("data",function(o){f+=o.toString()}),p.on("error",function(o){c(o)}),p.on("exit",function(o,A){n({stdout:r,stderr:f})})})}function d(t){s.default.existsSync(t)||s.default.mkdirSync(t,{recursive:!0})}function m(t){s.default.existsSync(t)&&s.default.rmSync(t,{recursive:!0})}var e=class{constructor(i){i=i||".",this.__installPath__=i,this.__venvPath__=_.default.join(i,"venv"),this.__scriptsPath__=_.default.join(i,"venv","Scripts"),this.__pythonPath__=_.default.join(i,"venv","Scripts",M),this.__pipPath__=_.default.join(i,"venv","Scripts",C),this.__isInitialized__=this.chkInit()}};e.prototype.getPyCmd=function(){return this.__isInitialized__?this.__pythonPath__:u};e.prototype.getPipCmd=function(){return this.__isInitialized__?this.__pipPath__:k};e.prototype.chkInit=function(){return s.default.existsSync(this.__installPath__)&&s.default.existsSync(this.__venvPath__)&&s.default.existsSync(this.__scriptsPath__)&&s.default.existsSync(this.__pythonPath__)&&s.default.existsSync(this.__pipPath__)};e.prototype.init=async function(t){if(!u)throw new Error(`${process.platform} has not been supported.`);if(!this.__isInitialized__&&(d(this.__installPath__),t&&m(this.__venvPath__),d(this.__venvPath__),await h(u,["-m","venv",this.__venvPath__]),this.__isInitialized__=this.chkInit(),!this.__isInitialized__))throw new Error("Can not create venv.")};e.prototype.destory=async function(){m(this.__venvPath__),this.__isInitialized__=this.chkInit()};e.prototype.freeze=async function(){return await h(this.getPipCmd(),["freeze"])};e.prototype.getModules=async function(){let{stdout:t,stderr:i}=await this.freeze();return t.replace(/\r\n/g,`
`).replace(/\n$/,"").split(/\n/).map(function(n){return{name:n.split("==")[0],version:n.split("==")[1]}})};e.prototype.install=async function(t,i){return await h(this.getPipCmd(),["install",t].concat(i||[]))};e.prototype.isInstalled=async function(t){let i=await this.getModules();for(let n of i)if(n.name.indexOf(t)===0)return!0;return!1};e.prototype.exec=async function(t,i){return await h(this.getPyCmd(),[t].concat(i||[]))};0&&(module.exports={Py});
